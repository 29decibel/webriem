<%= form_for @doc_head,:remote=>true,:html => {:class=>:doc_head} do |f| %>
<div class="form_title">
	<h3><%= @title%></h3>
</div>
<div id="doc_head_actions" class="actions">
	<%= render :partial=>"doc_head_actions",:locals=>{:doc_head=>@doc_head}%>	
</div>
<div id="doc_state_process">
	<%= render :partial=>"doc_state_process",:locals=>{:doc=>@doc_head}%>
</div>
<div class="form_title">
	<h3><%= "#{I18n.t('common_attr.basic_info')}"%></h3>
</div>
<div class="form_area">
		<div class="form_field">
      <span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.doc_no')}#{mark_required(f.object,:doc_no)}",:class=>"" %></span>
			<%= f.hidden_field :doc_no %>
			<%= f.hidden_field :id %>
			<%= f.hidden_field :doc_type %>
			<span class="doc_no value"><%= @doc_head.doc_no%></span>
		</div>
		<div class="form_field">
      <span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.person_id')}",:class=>"" %></span>
			<%= f.hidden_field :person_id %>
      <span class="value"><%= @doc_head.person_name%></span>
			<%= hidden_field_tag "duty_for_fee_standard",@doc_head.person.duty_id%>
			<%= hidden_field_tag "pt_for_fee_standard",@doc_head.person.person_type_id%>
		</div>
		<div class="form_field">
      <span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.apply_date')}#{mark_required(f.object,:apply_date)}",:class=>"" %></span>
      <span class="value"><%= f.text_field :apply_date,:class=>"datepicker input1 doc_apply_date",:placeholder=>"#{I18n.t('activerecord.attributes.doc_head.apply_date')}" %></span>
		</div>
    <% if @doc_head.doc_type!=14%>
		<div class="form_field">
			<span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.attach')}" %></span>
      <span class="value"><%= f.text_field :attach,:class=>"input1"+ mark_required(@doc_head, :attach),:placeholder=>"#{I18n.t('activerecord.attributes.doc_head.attach')}" %></span>  
		</div>
  <% end %>
		<div class="form_field">
			<span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.dep_id')}" %></span>
            <!--样例参照-->
			<span class="value"><div class="reference" data-ref-id="dep">
				<%= f.hidden_field :dep_id,{:class=>"ref_hidden_field"}%>
        <%= text_field_tag "dep_info",@doc_head.dep.to_s,:class=>"ref",:placeholder=>"#{I18n.t('activerecord.attributes.doc_head.dep_id')}" %>
				<a href="#" class-data="Dep" pre-condition-ref="" pre-condition-sql=""><span class="reference"></span></a>			
			</div>
		</div></span>
		<% if @doc_head.doc_type==9 or @doc_head.doc_type==11%>
		<div class="form_field">
			<span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.afford_dep_id')}" %></span>
            <!--样例参照-->
			<span class="value"><div class="reference afford_dep" data-ref-id="dep">
				<%= f.hidden_field :afford_dep_id,{:class=>"ref_hidden_field doc_afford_dep"}%>
        <%= text_field_tag "dep_info",@doc_head.afford_dep.to_s,:class=>"ref",:placeholder=>"#{I18n.t('activerecord.attributes.doc_head.afford_dep_id')}" %>
				<a href="#" class-data="Dep" pre-condition-ref="" pre-condition-sql=""><span class="reference"></span></a>			
			</div></span>
		</div>
		<% end %>
    <% if @doc_head.doc_type!=14%>
		<div class="form_field">
			<span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.real_person_id')}" %></span>
			<span class="value"><div class="reference">
				<%= f.hidden_field :real_person_id,{:class=>"ref_hidden_field"}%>
        <%= text_field_tag "real_person_info",@doc_head.real_person.to_s,:class=>"ref",:placeholder=>"#{I18n.t('activerecord.attributes.doc_head.real_person_id')}" %>
				<a href="#" class-data="Person" pre-condition-ref="" pre-condition-sql=""><span class="reference"></span></a>			
			</div></span>
    </div>
  <% end %>
	<% if @doc_head.doc_type==13 %>
		<div class="form_field">
			<span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.upload')}" %></span>
			<span class="value"><%= f.hidden_field :doc_no%>
			<% if @doc_head.upload_file %>
				<%= @doc_head.upload_file.upload.original_filename%>
			<% end %>
			<%= link_to_function("#{I18n.t('activerecord.attributes.doc_head.manage_upload')}","add_upload_files(this,'#{upload_files_path}')")%></span>
		</div>
	<% end %>
	<% if @doc_head.doc_type==1 %>
		<div class="form_field">
			<span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.cp_doc_remain_amount')}" %></span><span class="value"><%= @doc_head.cp_doc_remain_amount%></span>
		</div>
	<% end %>
	<% if ([9,11,13].include? @doc_head.doc_type)%>
		<% if @doc_head.doc_type!=13%>
		<div class="form_field">
			<span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.project_id')}" %></span>			
			<span class="value"><div class="reference project">
				<%= f.hidden_field :project_id,{:class=>"ref_hidden_field doc_project"}%>
        <%= text_field_tag "project_info",@doc_head.project.to_s,:class=>"ref",:placeholder=>"#{I18n.t('activerecord.attributes.doc_head.project_id')}" %>
				<a href="#" class-data="Project"><span class="reference"></span></a>			
			</div></span>
		</div>
		<% end %>
		<div class="form_field">
			<span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.is_split')}" %></span>
			<span class="value"><%= f.select :is_split, ReimDetail::ENUMS_IS_SPLIT,{},{:class=>"input1 is_split_reim"} %></span>
		</div>
  <% end %>
  <br/>
  <div class="form_field col-sp2">
    <span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.note')}" %></span>
    <span class="value"><%= f.text_area :note,:class=>"input2"+ mark_required(@doc_head, :note),:placeholder=>"#{I18n.t('activerecord.attributes.doc_head.note')}" %></span>
  </div>
  <br/>
  <div class="form_field">
    <span class="label"><%= f.label "#{I18n.t('activerecord.attributes.doc_head.total_apply_amount')}" %></span>
    <span class="value" id="total_riem"><%= @doc_head.total_fi_amount%></span>
  </div>
	<!---++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<%= f.hidden_field :doc_type%>
</div>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<!--根据不同的单据类型render不同的单据-->
<div id="details">
	<!---->
	<% if @doc_head.doc_type<=2%>
    <div class="doc_detail">
      <div class="form_title">
        <h3>
          <%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:cp_doc_details,[:dep] %>
          <%= @doc_head.doc_type==1 ? "#{I18n.t('activerecord.attributes.doc_head.cp_doc_details.c_doc')}":"#{I18n.t('activerecord.attributes.doc_head.cp_doc_details.p_doc')}" %>
          <%= image_tag "currency_yuan.png"%>
          <span class='doc_total_amount normal'>0.0</span>
        </h3>
    	</div>
	    <div class="form_area">
				<% f.fields_for :cp_doc_details do |builder|  %>
					<%= render :partial => 'cp_doc_detail_fields',:locals => { :f => builder } %>
				<% end %>
	     </div>
      </div>	
	<% end %>
	<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<% if @doc_head.doc_type==3%>
<div class="doc_detail">
	<div class="form_title">
    <h3>
      <%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:rec_notice_details %>
      <%= "#{I18n.t('common_attr.c_doc_detail')}"%>
      <%= image_tag "currency_yuan.png"%>
      <span class='doc_total_amount normal'>0.0</span>
    </h3>
	</div>
	<div class="form_area">
			<% f.fields_for :rec_notice_details do |builder| %>
				<%= render :partial => 'rec_notice_detail_fields',:locals => { :f => builder } %>
			<% end %>	
	</div>
</div>
	<% end %>
	<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->	
	<!--结汇申请单-->
	<% if @doc_head.doc_type==4%>
<div class="doc_detail">
	<div class="form_title">
		<h3><%= I18n.t("common_attr.remitance_detail")%></h3>
	</div>
	<div id="inner_remittance" class="form_area">
		<%= f.fields_for :inner_remittance do |builder|  %>
			<%= render :partial => 'inner_remittance',:locals => { :f => builder,:detail_doc=>@doc_head.inner_remittance }  %>
		<% end %>
	</div>
</div>
	<% end %>
	<!--转帐申请单-->
	<% if @doc_head.doc_type==5%>
<div class="doc_detail">
	<div class="form_title">
		<h3><%= I18n.t("common_attr.transfer_detail")%></h3>
	</div>
	<div id="inner_transfer" class="form_area">
		<%= f.fields_for :inner_transfer do |builder|  %>
			<%= render :partial => "inner_transfer",:locals => { :f => builder,:detail_doc=>@doc_head.inner_transfer }  %>
		<% end %>
	</div>
</div>
	<% end %>
	<!--现金提取申请单-->
	<% if @doc_head.doc_type==6%>
<div class="doc_detail">
	<div class="form_title">
		<h3><%= I18n.t("common_attr.cash_draw_detail")%></h3>
	</div>
	<div id="inner_cash_draw" class="form_area">
		<%= f.fields_for :inner_cash_draw do |builder|  %>
			<%= render :partial => "inner_cash_draw",:locals => { :f => builder,:detail_doc=>@doc_head.inner_cash_draw }  %>
		<% end %>
	</div>
</div>
	<% end %>
	<!--购买理财产品-->
	<% if @doc_head.doc_type==7%>
<div class="doc_detail">
	<div class="form_title">
		<h3><%= I18n.t("common_attr.buy_fin_p_detail")%></h3>
	</div>
	<div id="buy_finance_products" class="form_area">
		<%= f.fields_for :buy_finance_product do |builder|  %>
			<%= render :partial => "buy_finance_products",:locals => { :f => builder,:detail_doc=>@doc_head.buy_finance_product }  %>
		<% end %>
	</div>
</div>
	<% end %>
	<!--赎回理财产品-->
	<% if @doc_head.doc_type==8%>
<div class="doc_detail">
	<div class="form_title">
		<h3><%= I18n.t("common_attr.redeem_fin_p_detail")%></h3>
	</div>
	<div id="redeem_finance_products" class="form_area">
		<%= f.fields_for :redeem_finance_product do |builder|  %>
			<%= render :partial => "redeem_finance_products",:locals => { :f => builder,:detail_doc=>@doc_head.redeem_finance_product }  %>
		<% end %>
	</div>
</div>
	<% end %>
	<!--here is reim details...................................................-->
	<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<% if @doc_head.doc_type==9%>
<div class="doc_detail">
	<div class="form_title">
    <h3>
      <%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:rd_travels %>
      <%= "#{I18n.t('common_attr.travel_desc')}"%>
      <%= image_tag "currency_yuan.png"%>
      <span class='doc_total_amount normal'>0.0</span>
    </h3>
	</div>
		<div class="form_area">
			<%= f.fields_for :rd_travels do |builder| %>
				<%= render :partial => 'rd_travel_fields',:locals => { :f => builder } %>
			<% end %>				
		</div>
  </div>
<div class="doc_detail">
		<div class="form_title">
      <h3>
			  <%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:rd_transports %>
        <%= "#{I18n.t('common_attr.transport_detail')}"%>
        <%= image_tag "currency_yuan.png"%>
        <span class='doc_total_amount normal'>0.0</span>
      </h3>
		</div>
		<div class="form_area">
				<%= f.fields_for :rd_transports do |builder|  %>
						<%= render :partial => 'rd_transport_fields',:locals => { :f => builder }  %>
				<% end %>				
		</div>
  </div>
<div class="doc_detail">
		<div class="form_title">
      <h3>
				<%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:rd_lodgings %>
        <%= "#{I18n.t('common_attr.lodging_desc')}"%>
        <%= image_tag "currency_yuan.png"%>
        <span class='doc_total_amount normal'>0.0</span>
      </h3>
		</div>
		<div class="form_area">
				<%= f.fields_for :rd_lodgings do |builder|  %>
					<%= render :partial => 'rd_lodging_fields',:locals => { :f => builder }  %>
				<% end %>				
		</div>
  </div>
<div class="doc_detail">
		<div class="form_title">
      <h3>
				<%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:other_riems %>
        <%= "#{I18n.t('common_attr.other_riem_detail')}"%>
        <%= image_tag "currency_yuan.png"%>
        <span class='doc_total_amount normal'>0.0</span>
      </h3>
		</div>
		<div class="form_area">
				<%= f.fields_for :other_riems do |builder|  %>
					<%= render :partial => 'other_riem_fields',:locals => { :f => builder }  %>
				<% end %>				
		</div>
  </div>
	<% end %>
	<!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<% if @doc_head.doc_type==12%>
<div class="doc_detail">
	<div class="form_title">
    <h3>
		 	<%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:common_riems %>
      <%= "#{I18n.t('common_attr.common_riem_desc')}"%>
      <%= image_tag "currency_yuan.png"%>
      <span class='doc_total_amount normal'>0.0</span>
    </h3>
	</div>
		<div class="form_area">
			<%= f.fields_for :common_riems do |builder| %>
				<%= render :partial => 'common_riem_fields',:locals => { :f => builder } %>
			<% end %>				
		</div>
  </div>
	<% end %>
	<% if @doc_head.doc_type==10 or @doc_head.doc_type==12%>
<div class="doc_detail">
	<div class="form_title">
    <h3>
			<%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:rd_work_meals %>
      <%= @doc_head.doc_type==10 ? "#{I18n.t('common_attr.transport_fee')}" : "#{I18n.t('common_attr.work_meal')}"%><%= "#{I18n.t('common_attr.details')}"%>
      <%= image_tag "currency_yuan.png"%>
      <span class='doc_total_amount normal'>0.0</span>
    </h3>
	</div>
	<div class="form_area">
			<%= f.fields_for :rd_work_meals do |builder|  %>
				<%= render :partial => 'rd_work_meal_fields',:locals => { :f => builder }  %>
			<% end %>				
	</div>
</div>
	<% end %>
	<!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<% if @doc_head.doc_type==11%>
<div class="doc_detail">
	<div class="form_title">
    <h3>
			<%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:rd_extra_work_meals %>
      <%= "#{I18n.t('common_attr.extra_meal')}"%>
      <%= image_tag "currency_yuan.png"%>
      <span class='doc_total_amount normal'>0.0</span>
    </h3>
	</div>
	<div class="form_area">
			<%= f.fields_for :rd_extra_work_meals do |builder|  %>
				<%= render :partial => 'rd_extra_work_meal_fields',:locals => { :f => builder }  %>
			<% end %>			
	</div>
</div>
<div class="doc_detail">
	<div class="form_title">
    <h3>
			<%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:rd_extra_work_cars %>
      <%= "#{I18n.t('common_attr.extra_car')}"%>
      <%= image_tag "currency_yuan.png"%>
      <span class='doc_total_amount normal'>0.0</span>
    </h3>
	</div>
	<div class="form_area">
			<%= f.fields_for :rd_extra_work_cars do |builder|  %>
				<%= render :partial => 'rd_extra_work_car_fields',:locals => { :f => builder }  %>
			<% end %>				
	</div>
</div>
	<% end %>
	<!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<% if @doc_head.doc_type==12%>
<div class="doc_detail">
	<div class="form_title">
    <h3>
			<%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:rd_common_transports %>
      <%= "#{I18n.t('common_attr.common_transport')}"%>
      <%= image_tag "currency_yuan.png"%>
      <span class='doc_total_amount normal'>0.0</span>
    </h3>
	</div>
	<div class="form_area">
			<%= f.fields_for :rd_common_transports do |builder|  %>
				<%= render :partial => 'rd_common_transport_fields',:locals => { :f => builder }  %>
			<% end %>				
	</div>
</div>
	<% end %>
	<!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<% if @doc_head.doc_type==13%>
<div class="doc_detail">
	<div class="form_title">
    <h3>
			<%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:rd_benefits %>
      <%= "#{I18n.t('common_attr.benefit_detail')}"%>
      <%= image_tag "currency_yuan.png"%>
      <span class='doc_total_amount normal'>0.0</span>
    </h3>
	</div>
	<div class="form_area">
			<%= f.fields_for :rd_benefits do |builder|  %>
				<%= render :partial => 'rd_benefit_fields',:locals => { :f => builder }  %>
			<% end %>			
	</div>
</div>
	<% end %>
	<!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<% if @doc_head.doc_type==14%>
	<div class="form_title">
		<h3><%= "#{I18n.t('common_attr.fixed_property')}"%></h3>
	</div>
	<div class="form_area">
		<table class="form_input">
			<thead>
				<tr>					
					<th><%= "#{I18n.t('common_attr.sequence')}"%></th>
					<th><%= "#{I18n.t('activerecord.attributes.fixed_property.type')}"%></th>
					<th><%= "#{I18n.t('activerecord.attributes.fixed_property.name')}"%></th>
					<th><%= "#{I18n.t('activerecord.attributes.fixed_property.code')}"%></th>
					<th><%= "#{I18n.t('activerecord.attributes.fixed_property.sequence')}"%></th>
					<th><%= "#{I18n.t('activerecord.attributes.fixed_property.buy_unit')}"%></th>
					<th><%= "#{I18n.t('activerecord.attributes.fixed_property.buy_count')}"%></th>
					<th><%= "#{I18n.t('activerecord.attributes.fixed_property.original_value')}"%></th>
					<th><%= "#{I18n.t('activerecord.attributes.fixed_property.keeper_id')}"%></th>
					<th><%= "#{I18n.t('activerecord.attributes.fixed_property.place')}"%></th>
					<th><%= "#{I18n.t('activerecord.attributes.fixed_property.afford_dep_id')}"%></th>
					<th><%= "#{I18n.t('activerecord.attributes.fixed_property.project_id')}"%></th>
					<th></th><!--给删除的-->
			    </tr>
		    <thead>
			<tbody>
				<%= f.fields_for :fixed_properties do |builder|  %>
					<%= render "fixed_property_fields",:f => builder  %>
				<% end %>			
			</tbody>
			<tr>
				<th colspan="10"><%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:fixed_properties %></th>
				<td><%= "#{I18n.t('common_attr.total_apply_amount')}"%></td>
				<td><%= text_field_tag 'total_amount', nil, :class => 'doc_total_amount normal'%></td>
				<td></td>
			</tr>		
		</table>
	</div>
	<% end %>
	<!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<% if [9,11,13].include? @doc_head.doc_type%>
	<!--分摊明细动态显示-->
<div class="doc_detail">
	<div class="form_title is_split_reim">
    <h3>
      <%= link_to_add_fields "#{I18n.t('common_attr.add_detail')}",f,:reim_split_details %>
      <%= "#{I18n.t('common_attr.split_detail')}"%>
      <%= image_tag "currency_yuan.png"%>
      <span class='split_total_amount normal'>0.0</span>
    </h3>
	</div>
	<div class="form_area is_split_reim">
		<%= f.fields_for :reim_split_details do |builder|  %>
			<%= render :partial => "reim_split_detail_fields",:locals => { :f => builder }  %>
		<% end %>				
	</div>
</div>
	<% end %>
	<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<% if @doc_head.doc_type>=9 and @doc_head.doc_type<=12%>
		<div class="form_title">
			<h3><%= "#{I18n.t('common_attr.now_cp_docs')}"%></h3>
		</div>
		<%= render :partial => 'reim_cp_doc_offset',:locals => { :doc_head=>@doc_head }  %>
	<% end %>
	<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<% if @doc_head.doc_type<3 or @doc_head.doc_type>=9 and @doc_head.doc_type<=13%>
<div class="doc_detail recivers">
	<div class="form_title">
    <h3>
      <%= link_to_add_fields "#{I18n.t('common_attr.add_reciver')}",f,:recivers %>
      <%= @doc_head.doc_type==2?"#{I18n.t('common_attr.rec_company')}":"#{I18n.t('common_attr.rec_person')}"%><%= "#{I18n.t('common_attr.details')}"%>
    </h3>
	</div>
	<div class="form_area">
		<%= f.fields_for :recivers do |builder|  %>
			<%= render :partial => 'reciver_fields',:locals => { :f => builder }  %>
		<% end %>
	</div>	
</div>
	<% end %>
</div>
<% end %>
<!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<!--审批流++++++++根据当前单据状态以及当前审批人显示下面内容-->
<div id="work_flow_info">
	<%= render(:partial=>"work_flow_info",:locals=>{:work_flow_info=>@work_flow_info,:doc_head=>@doc_head})%>
</div>
